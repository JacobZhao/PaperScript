\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{caption}
\usepackage{subcaption}
% \usepackage{subfigure}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{enumerate}
\usepackage[colorinlistoftodos]{todonotes}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{Optimize Configuration For Mismatched PV System}
\author{\IEEEauthorblockN{Dafang Zhao, Fukuhito Ooshita, and Michiko Inoue}
%Email: 
\IEEEauthorblockA{Nara Institute of Science and Technology, Japan\\
Email:   \{zhao.dafang.yu7, f-ooshita, kounoe\}@is.naist.jp}}
\maketitle

\begin{abstract}
Power generation efficiency of Photovoltaic(PV) system are significantly affected by partial shading and solar cell damage. This efficiency loss caused by turning on bypass diode of PV panels, which we called mismatch loss. By using some reconfiguration technology to reconfigure electrical series or parallel connection can reduce the mismatch loss and maximize power generation. Recently, an efficient reconfiguration method is proposed. This method applies precise power simulations based on a list of configuration candidates. However, some of the configuration candidates are not be able to realized and this method does not show any systematic way to identify such feasibility. Thus, in this paper we propose a very fast algorithm to check feasibility and reduce wiring complexity.
\end{abstract}

% \begin{IEEEkeywords}
% component, formatting, style, styling, insert
% \end{IEEEkeywords}

\section{Introduction}
With fossil depleting and the pollution of the environment becomes more serious. Green and renewable energy have become necessary for a sustainable society and environment. Photovoltaic(PV) receive significant attention since it has unlimited energy and can be easily scaled up. However, due to the nature of photovoltaic cell structure, PV arrays are sensitive to partial shading and PV cell fault or aging. That means when PV cells or modules experience different irradiance or do not uniformly generate power, the PV array is mismatched and unable to efficiently generate power. Additionally, when PV array under mismatch condition it will accelerate aging and heating for PV cells. That will cause a short circuit of PV array for further damaging. In order to prevent damaging on PV array and maximize power generation many reconfiguration method been proposed.

A PV panel level reconfiguration using genetic algorithm (GA) is proposed in \cite{carotenuto2015evolutionary}. Though it can give a new configuration, but computing cost is significant and algorithm cannot generate the best configuration precisely. The work in \cite{nguyen2008adaptive} proposed a switch matrix to reconfigure shadowed PV array, but it can not be able to apply on large size PV array. Paper \cite{storey2013improved} using "irradiance level equalization" method to dynamic reconfigure PV array and improve power generation efficiency over 10\%. The work in \cite{malathy2017reconfiguration} employed Irradiation equivalence method by using swathing matrix relocate PV panels. At PV module level, paper \cite{wang2014architecture} proposed a dynamic programming algorithm to adaptively produce near-optimal reconfiguration, the work in \cite{storey2014optimized} proposed a method for dynamic reconfigure PV array based on string-configured topology.
Fig.\ref{compare} shows the difference of shadowed PV array between only using Global maximum point tracking method and using reconfiguration strategy.
% finding global maximum point tracking (without reconfiguration) 
% and reconfigured PV array.
It puts into evidence that after reconfiguration shadowed PV array be able to generate more power and Pâ€”V curve has only one peak which is very useful for maximum point tracking devices.

To give the reconfiguration more expeditiously, the mathematical searching algorithm needs to be developed instead of sample exhaustive searching algorithm. Reference \cite{faldella1991architectural} given a method based on the tabular searching algorithm, it performing well on small size PV array, but it is hard to apply on a large scale array. Paper \cite{iraji2017optimisation} proposed an algorithm based on particle swarm optimisation to find switch matrix topology. 

But the reference \cite{carotenuto2015evolutionary} -\cite{iraji2017optimisation} given reconfiguration methods either force on uniformly distributed shadow or using GA and exhaustive searching algorithm. Reference \cite{orozco2016optimized} developed a fast reconfiguration strategy by using approximated values of MPP current and voltage to generate configuration candidates. In this strategy, first list and calculate configuration candidates by a fast estimation method in \cite{orozco2015fast}, and for each candidate, precise power simulation are applied. However, when the size of PV array are extremely large, it's impossible to do power simulation for each configuration candidate, and some configuration candidates might not be feasible, this is, it is impossible to realize a configuration designed by given PV panels.

In this paper, we propose an algorithm to identify feasibility based on the configuration candidates from \cite{orozco2016optimized} and a new connection topology to increase system flexibility without loss too much accuracy. The layout of reaming sections as below. Section \ref{Sec2} illustrate the model setting of PV array and etc.. Section \ref{Sec3} give the details of configuration candidates from \cite{orozco2016optimized}. Section\ref{Sec4} is the definition of feasibility. Section \ref{Sec5} and \ref{Sec6} give the details of algorithm and evaluation. Section \ref{Sec7} is the simulation result. Conclusions are provided in the last section.
% By reconfigure electrical connection of mismatched PV array can increase power generation efficiency. 
\begin{figure}
    \centering
    \includegraphics[width=0.8\linewidth]{compare.eps}
    \caption{Maximum Power generation difference between before and after reconfiguration}
    \label{compare}
\end{figure}

\section{Photovoltaic array}\label{Sec2}
In this paper we use the following model of PV array, module, string and panel as showed in Fig.\ref{model}. In general, a PV array is a combination of multiple PV panels. Several series-connected PV panels in formed of a string. And several parallel connected string in formed of PV array. This is typical S-P network PV array. A PV panel usually formed by three series-connected PV module which in formed of several series-connected PV cells. For each PV module a bypass diode is connected in parallel for reversing the reverse current. PV cells in a PV panel may have different conditions (irradiance or fault) and hence have different  upper limits for their generated currents. Therefore, as shown in Fig.\ref{one_panel} for lower control voltage, only PV cells can generate high currents be able to work and other PV cells don't generate current with their bypass diode turned on. Fig.\ref{ser-par} show I-V character for two series and parallel connected PV panels. The series-connection structure accepts a wider range of control voltage and parallel-connection structure can generate higher current.
\begin{figure}
    \centering
    \includegraphics[width=0.8\linewidth]{module.png}
    \caption{PV array, string, module and panel}
    \label{model}
\end{figure}

When understanding the I-V characteristics of different structure of PV panels, by using the algorithm in \cite{carotenuto2014online} we can find the I-V curves of panels and (near) MPPs, short circuit current, open circuit voltage of each panel in mismatch condition. These values form a fingerprint of connection.
\begin{figure}
     \centering
     \begin{subfigure}[b]{0.8\linewidth}
         \centering
         \includegraphics[width=\linewidth]{one-panel.eps}
         \caption{I-V characteristics on different control voltage}
         \label{one_panel}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.8\linewidth}
         \centering
         \includegraphics[width=\linewidth]{ser-par.eps}
         \caption{Series and parallel connection I-V character}
         \label{ser-par}
     \end{subfigure}
        \caption{PV Panel I-V characteristic}
        \label{fig:three graphs}
\end{figure}
\section{Related works}\label{Sec3}
Orozco-Guierrez et al. proposed a fast reconfiguration algorithm for mismatched PV arrays \cite{orozco2016optimized}, where the online monitoring \cite{carotenuto2014online} and power estimation \cite{orozco2015fast} are utilized. For the method in \cite{orozco2016optimized}, first, close values will be approximated and then possible combinations of reconfiguration are enumerated. For each configuration candidates their generate power value are estimated by \cite{orozco2015fast} along with careful estimation of possible errors. This method provided a simplified feasibility check, for all possible configuration the representative value with some error rate \textit{err}. Select configuration candidates with \textit{err} from the largest estimation value.

This method has given configuration candidates designate the number of strings, current value of each string and the number of modules which not been bypassed of each string. Besides, the number of active modules are common for each string based on that each PV string are connected in parallel. However, for some configuration candidates, we may not be able to find such combination that fit the requirement. We find out the simple feasibility check based on the number of active PV modules for each representative current values in \cite{orozco2016optimized} is optimistic and does not always identify the infeasible case.
\section{Feasibility}\label{Sec4}
To execute a power simulation for a PV array. We need to assign panels into different location to realize the candidate configuration. The definition of feasibility is in Equation \ref{feasibility}. When the number of working modules in a string ($M_S$) are less than the number of working module per-string ($Q_M$), this configuration is infeasible.
\begin{equation}
    \left\{\begin{matrix}
        M_S < Q_{M} & & \text{Infeasible}\\ 
        M_S \geqslant Q_{M} & & \text{Feasible} 
    \end{matrix}\right.
    \label{feasibility}
\end{equation}

For example, An 3X3 PV array formed by 9 PV panels. The number of modules that are able to work at current value for each string as showed in Table \ref{not_feasible}.The dot in each block in form of a PV module. As the number of modules and the panel they belong to, it is straight forward that panel P1 for any current value it have at least 2 modules can work. Instead of panel P9 only have 1 module can work at 0.5A.
One configuration requires 6 modules working for each string at 0.5A, 0.5A and 3A($Q_M = 6$). According to Table \ref{not_feasible} there isn't any combination for such configuration. Of course we can compute it by using exhaustive searching. However it is time-consuming. So we need an algorithm to efficiently identify feasibility for each configuration candidates.

\begin{table}[htbp]
    \caption{Infeasible Example}
    \begin{center}
    \begin{tabular}{c|c|c|c|c|c|c|c|c|c}
    \hline\hline
             & P1 & P2  & P3  & P4 & P5 & P6  & P7  & P8  & P9  \\ \hline
         0.5A & ***& *** & *   & *  & ***& **  & *   & *** & * \\ \hline
         1.5A & ***& *** & *   & *  & ***&     & *   &     &   \\ \hline
         3A   & ** & **  & *   & *  & ** &     &     &     &   \\\hline \hline
    \end{tabular}
    \label{not_feasible}
    \end{center}
\end{table}
\section{An algorithm to identify feasibility}\label{Sec5}
In this section we proposed an algorithm to identify feasibility.
\subsection{Input And Output Of Algorithm}\label{Sec5_1}
The input of algorithm is the information of PV array and Configuration candidates. The information of PV array contains a set of panels and the number of working modules in each panel for each current values. Table \ref{Info_Array} shows the information of a PV panel from Table \ref{not_feasible} for configuration \{0.5A, 0.5A, 3A, $Q_M = 6$ \}.
\begin{table}[htbp]
    \caption{Information of PV Array}
    \begin{center}
    \begin{tabular}{c|c|c|c|c|c|c|c|c|c}
    \hline\hline
             & P1 & P2  & P3  & P4 & P5 & P6  & P7  & P8  & P9  \\ \hline
         String1-0.5A & 3& 3 & 1   & 1  & 3& 2  & 1   & 3 & 1 \\ \hline
         String2-0.5A & 3& 3 & 1   & 1  & 3& 2  & 1   & 3 & 1  \\ \hline
         String3-3A   & 2 & 2  & 1   & 1  & 2 & 0  &0   &0  &0  \\\hline \hline
    \end{tabular}
    \label{Info_Array}
    \end{center}
\end{table}
It terms that for panel P2, 3 modules are able to work on String1 or String2 and 2 modules are able to work on String3. Due to one panel can only connected to single string. So the output of algorithm is the feasibility answer for a configuration. That is, the algorithm determines whether there exists an assignment of panels to strings that realizes the configuration required.

\subsection{Algorithm}

Let the $S$ for the number of PV strings and $P$ be the number of PV panels, $M_{(i,p)}$ is the number of modules on panel $p$ at current value $i$. For each panel we consider the different vector $Loss[p,k] = M_{(i_{k-1},p)}-M_{(i_{k},p)} ,(k \leq S)$. This vector means if we use panel $p$ on current $k$  it will loss $Loss[p,k]$ working modules in current $k-1$. Without loss of generality, for each panel $p$, $Loss^*[p] = ( Loss[p,k_1], Loss[p,k_2],..., Loss[p,k_S] )$ and $Loss^*[p_i] \leq Loss^*[p_j]$ holds for any $i \leq j$. After sorting all panels in lexicographic order by vector $Loss^*[p]$, we will have a order for arranging panels in different location.

To assign panels in right location, following steps are required.
\begin{enumerate}[(1)]
\item 
\end{enumerate}
\subsection{Evaluation}

\section{Simulation}\label{Sec6}

\section{Conclusions}\label{Sec7}

\section*{Acknowledgment}


% \section*{References}

\renewcommand\refname{Reference}
\bibliographystyle{ieeetr}
\bibliography{reference}

\end{document}
